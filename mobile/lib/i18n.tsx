import { createContext, useContext, useEffect, useMemo, useState } from "react";
import { I18nManager } from "react-native";
import AsyncStorage from "@react-native-async-storage/async-storage";

type Lang = "en" | "ar";

const I18N_STORAGE_KEY = "app-language";

const baseStrings = {
  store: "Store",
  cart: "Cart",
  orders: "Orders",
  profile: "Profile",
  checkout: "Checkout",
  membership: "Membership",
  wallet: "Wallet",
  settings: "Settings",
  announcements: "Announcements",
  view: "View",
  addToCart: "Add to cart",
  placeOrder: "Place order",
  placingOrder: "Checking out",
  placeOrderSentenceLinker:"for",
  login: "Login",
  register: "Create account",
  forgotPassword: "Reset password",
  email: "Email",
  password: "Password",
  name: "Full name",
  continue: "Continue",
  loggingIn:'Logging in',
  backToLogin: "Back to login",
  pushNotifications: "Push notifications",
  language: "Language",
  theme: "Theme",
  system: "System",
  light: "Light",
  dark: "Dark",
  usePoints: "Use points reward",
  use: "Use",
  used: "Used",
  yes: "Yes",
  no: "No",
  distance: "Distance",
  deliveryFee: "Delivery fee",
  total: "Total",
  oldPrice: "Old price",
  newPrice: "New price",
  discount: "Discount",
  storeLocation: "Store location",
  orderHistory: "Order history",
  helloShopper: "Hello shopper",
  hello: "Hello",
  deliveryTo: "Delivery to",
  loginToLoadLocation: "No selected address.",
  featuredCategories: "Featured categories",
  freshPicks: "Fresh picks",
  amount: "Amount",
  submit: "Submit request",
  submitting: "Submitting...",
  rewards: "Points",
  redeemAvailable: "Reward available",
  balance: "Balance",
  coupons: "Coupons",
  couponCode: "Code",
  freeDelivery: "Free delivery",
  standard: "Standard",
  searchProducts: "Search products",
  shopTagline: "Discover fresh picks in your language & theme",
  shopByCategory: "Shop by category",
  noDescription: "No description",
  products: "Products",
  emptyProducts: "No products found",
  searching: "Searching...",
  subtotal: "Subtotal",
  clearCart: "Clear cart",
  order: "Order",
  status: "Status",
  timeline: "Timeline",
  items: "Items",
  pointsLeft: "points left to unlock a reward",
  earnPoints: "How to earn",
  earnPointsCopy: "Earn points on subtotal after delivery.",
  pointsBalance: "Points balance",
  pointEarnRate: "1 point per {amount} SYP on subtotal.",
  viewPoints: "View points",
  usePointsTitle: "How to use",
  usePointsCopy: "Apply reward during checkout for one order.",
  topUp: "Add funds to your wallet",
  topUpRequest: "Top-up request",
  registerFailed: "Could not register",
  invalidCredentials: "Invalid credentials",
  loginHeadline: "Grocery on the go.",
  loginSubhead: "Earn points, track orders, and level up your membership.",
  sendLink: "Send link",
  resetCopy: "We will send a recovery link to your email.",
  resetSent: "If this email exists, a link was sent.",
  guest: "Guest",
  role: "Role",
  logout: "Logout",
  address: "Address",
  phone: "Phone",
  latitude: "Latitude",
  longitude: "Longitude",
  level: "Level",
  remainingToNext: "Remaining to ",
  graceDays: "Grace days",
  gracePeriod: "Grace period",
  gracePeriodActive: "Grace period active",
  graceKeepLevel: "Keep your balance above",
  graceUntil: "Grace until",
  benefits: "Benefits",
  priorityDelivery: "Priority delivery",
  loyalOffers: "Extra offers for loyal members",
  congrats: "Congratulations! You are at the top level membership",
  leveledUp: "You just leveled up.",
  loginToSeeOrders: "Please login to view your orders.",
  walletLedger: "History",
  noTransactions: "No transactions yet",
  filters: "Filters",
  clear: "Clear",
  sortBy: "Sort by",
  relevance: "Relevance",
  priceLowHigh: "Price: Low to High",
  priceHighLow: "Price: High to Low",
  price: "Price",
  all: "All",
  under50k: "Under 50K",
  under100k: "Under 100K",
  over100k: "100K +",
  apply: "Apply",
  invalidCoupon: "Invalid coupon",
  remove: "Remove",
  loginToSeeProfile: "Please login to view your profile.",
  confirmRemove: "Remove item?",
  confirmRemoveCopy: "Are you sure you want to remove this item from your cart?",
  dontAskAgain: "Don't ask again",
  emptyCartTitle: "Your cart is empty",
  emptyCartCopy: "Add items to your cart to see them here.",
  startBrowsing: "Start browsing",
  confirmClearCart: "Clear cart?",
  confirmClearCartCopy: "This will remove all items from your cart.",
  orderPlaced: "Order placed!",
  orderPlacedCopy: "Your order is confirmed and on its way.",
  trackOrder: "Track order",
  back: "Back",
  viewAll: "View all",
  tapToSetLocation: "Enter coordinates to set location",
  loginToCheckout: "Login to checkout",
  savedAddresses: "Saved addresses",
  addAddress: "Add address",
  editAddress: "Edit address",
  noOrders: "No orders yet",
  noOrdersHint: "Start browsing to place your first order.",
  notLoggedIn: "You are not logged in",
  guestInfo: "Guest information",
  fillGuestForm: "Fill the form below or login.",
  loginOrGuest: "Login or checkout as guest",
  chooseAddress: "Choose address",
  noAddresses: "No addresses saved yet.",
  label: "Label",
  save: "Save",
  cancel: "Cancel",
  delete: "Delete",
  edit: "Edit",
  useCurrentLocation: "Use current location",
  show: "Show",
  hide: "Hide",
  manageAddresses: "Manage addresses",
  change: "Change",
  paymentMethod: "Payment method",
  close: "Close",
  done:"Done",
  locationDenied: "Permission denied",
  locationError: "Could not get location",
  noResults: "No results found",
  learnMore: "Learn more",
  WalletBalance: "Wallet balance",
  syp: "SYP",
  km:"Km",
  alreadyHaveAnAccount: "Already have an account?",
  addNewAddress: "Add a new address",
  off: "off",
};

const arStrings: Record<string, string> = {
  store: "Ø§Ù„Ù…ØªØ¬Ø±",
  cart: "Ø§Ù„Ø³Ù„Ø©",
  orders: "Ø§Ù„Ø·Ù„Ø¨Ø§Øª",
  profile: "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ",
  checkout: "Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨",
  membership: "Ø§Ù„Ø¹Ø¶ÙˆÙŠØ©",
  wallet: "Ø§Ù„Ù…Ø­ÙØ¸Ø©",
  settings: "Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
  addToCart: "Ø£Ø¶Ù Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©",
  placeOrder: "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨",
  placingOrder: "Ø¬Ø§Ø±Ù Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨",
  placeOrderSentenceLinker:"Ø¨Ù‚ÙŠÙ…Ø©",
  login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
  register: "Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
  forgotPassword: "Ø§Ø³ØªØ¹Ø§Ø¯Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
  email: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ",
  password: "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±",
  name: "Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„",
  continue: "Ù…ØªØ§Ø¨Ø¹Ø©",
  loggingIn:'Ø¬Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
  backToLogin: "Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„",
  pushNotifications: "Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¯ÙØ¹",
  language: "Ø§Ù„Ù„ØºØ©",
  theme: "Ø§Ù„Ù…Ø¸Ù‡Ø±",
  system: "Ø§Ù„Ù†Ø¸Ø§Ù…",
  light: "ÙØ§ØªØ­",
  dark: "Ø¯Ø§ÙƒÙ†",
  usePoints: "Ø§Ø³ØªØ®Ø¯Ù… Ù†Ù‚Ø§Ø· Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©",

  use: "Ø§Ø³ØªØ®Ø¯Ù…",
  used: "Ù…Ø³ØªØ®Ø¯Ù…",
  yes: "Ù†Ø¹Ù…",
  no: "Ù„Ø§",
  distance: "Ø§Ù„Ù…Ø³Ø§ÙØ©",
  deliveryFee: "Ø±Ø³ÙˆÙ… Ø§Ù„ØªÙˆØµÙŠÙ„",
  total: "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ",
  oldPrice: "ÇáÓÚÑ ÇáŞÏíã",
  newPrice: "ÇáÓÚÑ ÇáÌÏíÏ",
  discount: "?????",
  storeLocation: "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…ØªØ¬Ø±",
  orderHistory: "Ø³Ø¬Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª",
  helloShopper: "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ø§Ù„Ù…ØªØ³ÙˆÙ‚",
  hello: "Ù…Ø±Ø­Ø¨Ø§Ù‹",
  deliveryTo: "Ø§Ù„ØªÙˆØµÙŠÙ„ Ø¥Ù„Ù‰",
  loginToLoadLocation: "Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ø¹Ù†ÙˆØ§Ù†Ùƒ.",
  featuredCategories: "ÙØ¦Ø§Øª Ù…Ù…ÙŠØ²Ø©",
  freshPicks: "Ù…Ø®ØªØ§Ø±Ø§Øª Ø·Ø§Ø²Ø¬Ø©",
  amount: "Ø§Ù„Ù…Ø¨Ù„Øº",
  submit: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨",
  submitting: "Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„",
  rewards: "Ø§Ù„Ù†Ù‚Ø§Ø·",
  redeemAvailable: "Ù…ÙƒØ§ÙØ£Ø© Ù…ØªØ§Ø­Ø©",
  balance: "Ø§Ù„Ø±ØµÙŠØ¯",
  coupons: "ÙƒÙˆØ¨ÙˆÙ†Ø§Øª",
  couponCode: "Ø§Ù„Ø±Ù…Ø²",
  freeDelivery: "????? ?????",
  standard: "Ø£Ø³Ø§Ø³ÙŠ",
  searchProducts: "Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
  shopTagline: "Ø§ÙƒØªØ´Ù Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ù„ØºØªÙƒ ÙˆØ¨Ù…Ø¸Ù‡Ø±Ùƒ",
  shopByCategory: "ØªØ³ÙˆÙ‚ Ø­Ø³Ø¨ Ø§Ù„ÙØ¦Ø©",
  noDescription: "Ø¨Ø¯ÙˆÙ† ÙˆØµÙ",
  products: "Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª",
  emptyProducts: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª",
  searching: "Ø¬Ø§Ø±Ù Ø§Ù„Ø¨Ø­Ø«...",
  subtotal: "Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ",
  clearCart: "Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©",
  order: "Ø§Ù„Ø·Ù„Ø¨",
  status: "Ø§Ù„Ø­Ø§Ù„Ø©",
  timeline: "Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ø²Ù…Ù†ÙŠ",
  items: "Ø§Ù„Ø¹Ù†Ø§ØµØ±",
  pointsLeft: "Ù†Ù‚Ø§Ø· Ù…ØªØ¨Ù‚ÙŠØ© Ù„ÙØªØ­ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø©",
  earnPoints: "ÙƒÙŠÙÙŠØ© ÙƒØ³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·",
  earnPointsCopy: "Ø§ÙƒØ³Ø¨ Ù†Ù‚Ø§Ø·Ø§Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„ÙØ±Ø¹ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªÙˆØµÙŠÙ„.",
  pointsBalance: "Ø±ØµÙŠØ¯ Ø§Ù„Ù†Ù‚Ø§Ø·",
  pointEarnRate: "Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© Ù„ÙƒÙ„ {amount} Ù„.Ø³ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ.",
  viewPoints: "Ø¹Ø±Ø¶ Ø§Ù„Ù†Ù‚Ø§Ø·",
  usePointsTitle: "ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…",
  usePointsCopy: "Ø·Ø¨Ù‚ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¯ÙØ¹ Ù„Ø·Ù„Ø¨ ÙˆØ§Ø­Ø¯.",
  topUp: "Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯",
  topUpRequest: "Ø·Ù„Ø¨ Ø´Ø­Ù†",
  registerFailed: "ØªØ¹Ø°Ø± Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨",
  invalidCredentials: "Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©",
  loginHeadline: "Ø¨Ù‚Ø§Ù„ØªÙƒ ÙÙŠ Ù…ØªÙ†Ø§ÙˆÙ„Ùƒ.",
  loginSubhead: "Ø§ÙƒØ³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø·ØŒ ØªØªØ¨Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ ÙˆØ§Ø±ØªÙ‚Ù Ø¨Ø¹Ø¶ÙˆÙŠØªÙƒ.",
  sendLink: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·",
  resetCopy: "Ø³Ù†Ø±Ø³Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø¨Ø±ÙŠØ¯Ùƒ.",
  resetSent: "Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ØŒ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø§Ø¨Ø·.",
  guest: "Ø²Ø§Ø¦Ø±",
  role: "Ø§Ù„Ø¯ÙˆØ±",
  logout: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬",
  address: "Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",
  phone: "Ø§Ù„Ù‡Ø§ØªÙ",
  latitude: "Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶",
  longitude: "Ø®Ø· Ø§Ù„Ø·ÙˆÙ„",
  level: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰",
  remainingToNext: "Ù…ØªØ¨Ù‚ÙŠ Ø¥Ù„Ù‰ ",
  graceDays: "Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ù…Ø§Ø­",
  gracePeriod: "ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­",
  gracePeriodActive: "ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ Ù…ÙØ¹Ù‘Ù„Ø©",
  graceKeepLevel: "Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø±ØµÙŠØ¯ ÙÙˆÙ‚",
  graceUntil: "ÙØªØ±Ø© Ø§Ù„Ø³Ù…Ø§Ø­ Ø­ØªÙ‰",
  benefits: "Ø§Ù„Ù…Ø²Ø§ÙŠØ§",
  priorityDelivery: "ØªÙˆØµÙŠÙ„ Ø£ÙˆÙ„ÙˆÙŠØ©",
  loyalOffers: "Ø¹Ø±ÙˆØ¶ Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ÙˆÙØ§Ø¡",
  congrats: "ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø£Ù†Øª ÙÙŠ Ø£Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø¹Ø¶ÙˆÙŠØ©",
  leveledUp: "Ù„Ù‚Ø¯ Ø§Ø±ØªÙ‚ÙŠØª Ù„Ù„ØªÙˆ.",
  loginToSeeOrders: "ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§ØªÙƒ.",
  walletLedger: "Ø§Ù„Ø³Ø¬Ù„",
  noTransactions: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª Ø¨Ø¹Ø¯",
  filters: "Ø§Ù„ÙÙ„Ø§ØªØ±",
  clear: "ØªØµÙÙŠØ©",
  sortBy: "Ø§Ù„ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨",
  relevance: "Ø§Ù„ØµÙ„Ø©",
  priceLowHigh: "Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø£Ø¹Ù„Ù‰",
  priceHighLow: "Ø§Ù„Ø³Ø¹Ø±: Ù…Ù† Ø§Ù„Ø£Ø¹Ù„Ù‰ Ù„Ù„Ø£Ù‚Ù„",
  price: "Ø§Ù„Ø³Ø¹Ø±",
  all: "Ø§Ù„ÙƒÙ„",
  under50k: "Ø£Ù‚Ù„ Ù…Ù† 50 Ø£Ù„Ù",
  under100k: "Ø£Ù‚Ù„ Ù…Ù† 100 Ø£Ù„Ù",
  over100k: "100 Ø£Ù„Ù ÙˆØ£ÙƒØ«Ø±",
  apply: "ØªØ·Ø¨ÙŠÙ‚",
  invalidCoupon: "????? ??? ?????",
  remove: "Ø¥Ø²Ø§Ù„Ø©",
  loginToSeeProfile: "ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ù…Ù„ÙÙƒ.",
  confirmRemove: "Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ±ØŸ",
  confirmRemoveCopy: "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„Ø© Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù† Ø³Ù„ØªÙƒØŸ",
  dontAskAgain: "Ù„Ø§ ØªØ³Ø£Ù„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰",
  emptyCartTitle: "Ø³Ù„ØªÙƒ ÙØ§Ø±ØºØ©",
  emptyCartCopy: "Ø£Ø¶Ù Ø¹Ù†Ø§ØµØ± Ø¥Ù„Ù‰ Ø³Ù„ØªÙƒ Ù„ØªØ¸Ù‡Ø± Ù‡Ù†Ø§.",
  startBrowsing: "Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚",
  confirmClearCart: "Ø¥ÙØ±Ø§Øº Ø§Ù„Ø³Ù„Ø©ØŸ",
  confirmClearCartCopy: "Ø³ÙŠØ¤Ø¯ÙŠ Ù‡Ø°Ø§ Ø¥Ù„Ù‰ Ø¥Ø²Ø§Ù„Ø© ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ù…Ù† Ø§Ù„Ø³Ù„Ø©.",
  back: "Ø±Ø¬ÙˆØ¹",
  viewAll: "Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„",
  tapToSetLocation: "Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ÙˆÙ‚Ø¹",
  loginToCheckout: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨",
  savedAddresses: "Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©",
  addAddress: "Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ÙˆØ§Ù†",
  editAddress: "ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†",
  noOrders: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯",
  noOrdersHint: "Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚ Ù„ØªØ¶Ø¹ Ø£ÙˆÙ„ Ø·Ù„Ø¨.",
  notLoggedIn: "Ù„Ø³Øª Ù…Ø³Ø¬Ù„Ø§Ù‹",
  guestInfo: "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø²Ø§Ø¦Ø±",
  fillGuestForm: "Ø§Ù…Ù„Ø£ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø£Ø¯Ù†Ø§Ù‡ Ø£Ùˆ Ø³Ø¬Ù‘Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„.",
  loginOrGuest: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£Ùˆ Ø§Ù„Ø¯ÙØ¹ ÙƒØ²Ø§Ø¦Ø±",
  chooseAddress: "Ø§Ø®ØªØ± Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹",
  noAddresses: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ÙˆÙŠÙ† Ù…Ø­ÙÙˆØ¸Ø© Ø¨Ø¹Ø¯.",
  label: "Ø§Ù„Ù…Ø³Ù…Ù‰",
  save: "Ø­ÙØ¸",
  cancel: "Ø¥Ù„ØºØ§Ø¡",
  delete: "Ø­Ø°Ù",
  edit: "ØªØ¹Ø¯ÙŠÙ„",
  useCurrentLocation: "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆÙ‚Ø¹ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠ",
  show: "Ø¥Ø¸Ù‡Ø§Ø±",
  hide: "Ø¥Ø®ÙØ§Ø¡",
  manageAddresses: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†",
  change: "ØªØºÙŠÙŠØ±",
  paymentMethod: "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹",
  close: "Ø¥ØºÙ„Ø§Ù‚",
  done:"ØªÙ…",
  locationDenied: "ØªÙ… Ø±ÙØ¶ Ø¥Ø°Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹",
  locationError: "ØªØ¹Ø°Ø± Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹",
  noResults: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬",
  learnMore: "Ø§Ø¹Ø±Ù Ø§Ù„Ù…Ø²ÙŠØ¯",
  WalletBalance: "Ø±ØµÙŠØ¯ Ø§Ù„Ù…Ø­ÙØ¸Ø©",
  syp: "Ù„.Ø³",
  km: "ÙƒÙ…",  
  alreadyHaveAnAccount:"Ù‡Ù„ Ø£Ù†Ø´Ø£Øª Ø­Ø³Ø§Ø¨ Ù…Ù† Ù‚Ø¨Ù„ØŸ",
  addNewAddress:"Ø¥Ø¶Ø§ÙØ© Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÙŠØ¯"
};

const messages: Record<Lang, Record<string, string>> = {
  en: { ...baseStrings },
  ar: { ...arStrings },
};

interface I18nContextValue {
  lang: Lang;
  t: (key: string) => string;
  setLang: (lang: Lang) => void;
  isRTL: boolean;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

const detectDeviceLang = (): Lang => {
  const locale = (Intl.DateTimeFormat().resolvedOptions().locale || "en").toLowerCase();
  return locale.startsWith("ar") ? "ar" : "en";
};

export const I18nProvider = ({ children }: { children: React.ReactNode }) => {
  const [lang, setLangState] = useState<Lang>(detectDeviceLang());

  useEffect(() => {
    AsyncStorage.getItem(I18N_STORAGE_KEY).then((stored) => {
      if (stored === "en" || stored === "ar") setLangState(stored);
    });
  }, []);

  useEffect(() => {
    const shouldRTL = lang === "ar";
    if (I18nManager.isRTL !== shouldRTL) {
      I18nManager.allowRTL(true);
      I18nManager.forceRTL(shouldRTL);
      I18nManager.swapLeftAndRightInRTL(true);
      // Note: Expo/React Native may require an app reload for full mirroring; components use isRTL for live layout.
    }
  }, [lang]);

  const setLang = (next: Lang) => {
    setLangState(next);
    AsyncStorage.setItem(I18N_STORAGE_KEY, next).catch(() => { });
  };

  const value = useMemo<I18nContextValue>(() => {
    const dict = messages[lang] || messages.en;
    const t = (key: string) => dict[key] ?? messages.en[key] ?? key;
    return { lang, t, setLang, isRTL: lang === "ar" };
  }, [lang]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
};

export const useI18n = () => {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error("useI18n must be used within I18nProvider");
  return ctx;
};